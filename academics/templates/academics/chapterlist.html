{% extends "base.html" %}
    {% block chapterlist %}
        
    <div class="box">

      {% csrf_token %}  
     
       {{form.as_p}}
        <button id="chapter-btn" onclick=getchapter()>Getchapters</button>
   
    
        </div> 
   
        <script>
            function getchapter() {
            let token=localStorage.getItem("token")
               var grade = document.getElementById('id_grade').value
               var subject = document.getElementById('id_subject').value
               console.log(grade+subject)
               fetch('https://schooltestproject.herokuapp.com/api/chapter-list/',{
                   method: 'POST',
                   body: JSON.stringify({ 'grade': grade,'subject':subject}
                   ),
                   headers: new Headers( {
                       'Accept':'application/json',
                       'Content-Type': 'application/json',
                       'Authorization':'token'+' '+token 
               })
               }).then(response => {
                return response.json()
            }).then(data=>{
                console.log(data);
                let path = `
                <div class="chapters">
                    <div class="download">download your pdf file<a href="https://schooltestproject.herokuapp.com${data.path}"> here</a></div>
                </div>`;
                let container = document.querySelector('.chapters');
                container.innerHTML = path;
            })
        }
        function logout(){
            let token=localStorage.getItem("token")            
            console.log(token)            
            fetch('https://schooltestproject.herokuapp.com/api/logout/',            
            {            
            method: 'GET',            
            headers: {            
            'Content-Type': 'application/json',            
            'Authorization':'token'+' '+token,            
            // 'Content-Type': 'application/x-www-form-urlencoded',            
            }            
            }) .then(response => response.text())            
            window.location.href='login'            
            } 
        </script>     
        <div class="chapters">

        </div>
{% endblock %}

        
      